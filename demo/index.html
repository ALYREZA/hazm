<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>هضم</title>
	<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
	<link rel="stylesheet" href="http://sobhe.ap01.aws.af.cm/css/Fonts.css">
	<link rel="stylesheet" href="../stylesheets/pygment_trac.css">
	<link rel="stylesheet" href="../stylesheets/main.css">
</head>
<body>
<div class="header">
	<div class="container">
		<h1>هضم</h1>
		<p>برای پردازش زبان فارسی در پایتون</p>
		<div class="menu">
			<a href="https://github.com/sobhe/hazm"><span class="glyphicon glyphicon-tree-deciduous"></span> هم‌راهی</a>
			<a href="https://github.com/sobhe/hazm/archive/master.zip"><span class="glyphicon glyphicon-download"></span> دریافت</a>
		</div>
	</div>
</div>
<div class="container content">
	<div id="query">
		<h3>متن ورودی</h3>
		<textarea class="form-control" style="min-height: 80px">هربار وقتي از سفري به ايران بر مي گردم ، دوست دارم سر فرو بيافکنم و برخاک سرزمينم بوسه اي بيافشانم. اين اولين بار بود که چنين حسي نداشتم. برعکس ، پاره اي از تنم را جا گذاشته بودم پشت خطوط مرزي ، خطوط بي راه و بي روح مرزي.</textarea>
		<div class="controls">
			<button class="btn btn-default">پردازش</button><span class="loading"></span>
		</div>
	</div>
	<div class="demo" id="normalized">
		<h3>متن تمیز</h3>
		<div></div>
	</div>
	<div class="demo" id="tokenized">
		<h3>واژه‌های متن</h3>
		<div></div>
	</div>
	<div class="demo" id="lemmatized">
		<h3>ریشه واژه‌ها</h3>
		<div></div>
	</div>
	<div class="demo" id="tagged">
		<h3>تحلیل صرفی</h3>
		<div></div>
	</div>
	<div class="demo" id="parsed">
		<h3>تجزیه نحوی</h3>
		<div></div>
	</div>
</div>
<div class="container footer">
	<p>کاری از <a href="http://www.sobhe.ir">سُبحه</a></p>
</div>

<link rel="stylesheet" href="http://www.sobhe.ir/dependency-parse-tree/tree.css" type="text/css" media="screen" />
<script type="text/javascript" src="http://www.sobhe.ir/dependency-parse-tree/d3.js"></script>
<script type="text/javascript" src="http://www.sobhe.ir/dependency-parse-tree/dependency-tree.js"> </script>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
	var server = 'https://hazm-nournia.rhcloud.com/api';

	var normalize = function(text) {
		$.post(server + '/normalize', {'text': text})
			.done(function(normalized_text) {
				$('#normalized').show().find('div').text(normalized_text);
				tokenize(normalized_text);
			})
	};
	var tokenize = function(normalized_text) {
		$.post(server + '/tokenize', {'normalized_text': normalized_text})
			.done(function(tokenized_text) {
				tag(tokenized_text);

				sentences = $.parseJSON(tokenized_text);
				$('#tokenized').show().find('div').empty();
				for (s in sentences)
					$('#tokenized div').append('<li>'+ sentences[s].join(' ') +'</li>');
			});
	};
	var tag = function(tokenized_text) {
		$.post(server + '/tag', {'tokenized_text': tokenized_text})
			.done(function(tagged_text) {
				lemmatize(tagged_text);
				parse(tagged_text);

				sentences = $.parseJSON(tagged_text);
				$('#tagged').show().find('div').empty();
				for (s in sentences) {
					sentence = $.map(sentences[s], function(word) { return word.join('/'); });
					$('#tagged div').append('<li>'+ sentence.join(' ') +'</li>');
				}
			});
	};
	var lemmatize = function(tagged_text) {
		$.post(server + '/lemmatize', {'tagged_text': tagged_text})
			.done(function(lemmatized_text) {
				sentences = $.parseJSON(lemmatized_text);
				$('#lemmatized').show().find('div').empty();
				for (s in sentences)
					$('#lemmatized div').append('<li>'+ sentences[s].join(' ') +'</li>');
			});
	};
	var parse = function(tagged_text) {
		$.post(server + '/parse', {'tagged_text': tagged_text})
			.done(function(parsed_text) {
				sentences = $.parseJSON(parsed_text);
				div = $('#parsed > div'); div.empty();
				for (s in sentences) {
					if (sentences[s].length) {
						div.append('<div class="tree"><svg id="tree'+ s +'"></svg></div>');
						drawTree('#tree'+ s, sentences[s].replace(/_/g,' '));
					}
				}
				$('#parsed').show();
			})
			.always(function() {
				$('#query .btn').removeAttr('disabled');
				$('#query .loading').hide();
			});
	};

	$(function () {
		$('#query .btn').click(function() {
			normalize($('#query textarea').val());
			$('.demo').hide();
			$('#query .loading').show();
			$('#query .btn').attr('disabled','disabled');
		});
	})
</script>
</body>
</html>