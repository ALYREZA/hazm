<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>هضم</title>
	<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
	<link rel="stylesheet" href="http://sobhe.ap01.aws.af.cm/css/Fonts.css">
	<link rel="stylesheet" href="../stylesheets/pygment_trac.css">
	<link rel="stylesheet" href="../stylesheets/main.css">
</head>
<body>
<div class="header">
	<div class="container">
		<h1>هضم</h1>
		<p>برای پردازش زبان فارسی در پایتون</p>
		<div class="menu">
			<a href="http://www.ommidvar.ir/hazm" onclick="mixpanel.track('Donate Link')"><span class="glyphicon glyphicon-tree-deciduous"></span> حمایت از پروژه</a>
			<a href="https://github.com/sobhe/hazm"><span class="glyphicon glyphicon-send"></span> کدها</a>
			<a href="https://github.com/sobhe/hazm/archive/master.zip"><span class="glyphicon glyphicon-download"></span> دریافت</a>
		</div>
	</div>
</div>
<div class="container content">
	<div id="query">
		<h3>متن ورودی</h3>
		<textarea class="form-control" style="min-height: 80px">هربار وقتي از سفري به ايران بر مي گردم ، دوست دارم سر فرو بيافکنم و برخاک سرزمينم بوسه اي بيافشانم. اين اولين بار بود که چنين حسي نداشتم. برعکس ، پاره اي از تنم را جا گذاشته بودم پشت خطوط مرزي ، خطوط بي راه و بي روح مرزي.</textarea>
		<div class="controls">
			<button id="process" class="btn btn-primary">پردازش</button>
			<button id="tag" class="btn btn-success">تحلیل صرفی</button>
			<button id="parse" class="btn btn-danger">تجزیه نحوی</button>
			<span class="loading"></span>
		</div>
	</div>
	<div class="demo" id="normalized">
		<h3>متن تمیز</h3>
		<div></div>
	</div>
	<div class="demo" id="tokenized">
		<h3>واژه‌های متن</h3>
		<div></div>
	</div>
	<div class="demo" id="lemmatized">
		<h3>ریشه واژه‌ها</h3>
		<div></div>
	</div>
	<div class="demo" id="tagged">
		<h3>تحلیل صرفی</h3>
		<div></div>
	</div>
	<div class="demo" id="parsed">
		<h3>تجزیه نحوی</h3>
		<div></div>
	</div>
</div>
<div class="container footer">
	<p>کاری از <a href="http://www.sobhe.ir">سُبحه</a></p>
</div>

<link rel="stylesheet" href="http://www.sobhe.ir/dependency-parse-tree/tree.css" type="text/css" media="screen" />
<script type="text/javascript" src="http://www.sobhe.ir/dependency-parse-tree/d3.js"></script>
<script type="text/javascript" src="http://www.sobhe.ir/dependency-parse-tree/dependency-tree.js"> </script>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
	var server = 'https://hazm-nournia.rhcloud.com/api';

	var normalize = function(data) {
		$.post(server + '/normalize', data)
			.done(function(normalized_text) {
				$('#normalized').show().find('div').text(normalized_text);
				tokenize({'normalized_text': normalized_text});
			})
	};
	var tokenize = function(data) {
		$.post(server + '/tokenize', data)
			.done(function(tokenized_text) {
				lemmatize({'tokenized_text': tokenized_text})
				$('#tag').attr('tokenized_text', tokenized_text).show();

				sentences = $.parseJSON(tokenized_text);
				$('#tokenized').show().find('div').empty();
				for (s in sentences)
					$('#tokenized div').append('<li>'+ sentences[s].join(' ') +'</li>');
			})
			.always(hideLoading);
	};
	var lemmatize = function(data) {
		$.post(server + '/lemmatize', data)
			.done(function(lemmatized_text) {
				sentences = $.parseJSON(lemmatized_text);
				$('#lemmatized').show().find('div').empty();
				for (s in sentences)
					$('#lemmatized div').append('<li>'+ sentences[s].join(' ') +'</li>');
			});
	};
	var tag = function(data) {
		$.post(server + '/tag', data)
			.done(function(tagged_text) {
				lemmatize({'tagged_text': tagged_text});
				$('#tag').hide();
				$('#parse').attr('tagged_text', tagged_text).show();

				sentences = $.parseJSON(tagged_text);
				$('#tagged').show().find('div').empty();
				for (s in sentences) {
					sentence = $.map(sentences[s], function(word) { return word.join('/'); });
					$('#tagged div').append('<li>'+ sentence.join(' ') +'</li>');
				}
			})
			.always(hideLoading);
	};
	var parse = function(data) {
		$.post(server + '/parse', data)
			.done(function(parsed_text) {
				$('#parse').hide();

				sentences = $.parseJSON(parsed_text);
				div = $('#parsed > div'); div.empty();
				for (s in sentences) {
					if (sentences[s].length) {
						div.append('<div class="tree"><svg id="tree'+ s +'"></svg></div>');
						drawTree('#tree'+ s, sentences[s].replace(/_/g,' '));
					}
				}
				$('#parsed').show();
			})
			.always(hideLoading);
	};

	var hideLoading = function() {
		$('#query .btn').removeAttr('disabled');
		$('#query .loading').hide();
	}
	var showLoading = function() {
		$('#query .loading').show();
		$('#query .btn').attr('disabled','disabled');
	}

	$('#process').click(function() {
		$('.demo, #tag, #parse').hide();
		normalize({'text': $('#query textarea').val()});
		showLoading();
	});
	$('#tag').click(function() {
		tag({'tokenized_text': $(this).attr('tokenized_text')});
		showLoading();
	});
	$('#parse').click(function() {
		parse({'tagged_text': $(this).attr('tagged_text')});
		showLoading();
	});
</script>

<script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" "); for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="http://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]); mixpanel.init("a0573846705a6e929c17adf747ee8955");</script>
<script type="text/javascript">
	mixpanel.track('Demo Page');
</script>
</body>
</html>